bug_id,severity,category,component,files,description,root_cause,impact,fix,verification,status
"VTR-001","Critical","Security/Availability","WireGuard packet handling","src/wireguard.rs:205","Malformed UDP payloads caused decapsulation errors that terminated the daemon.","handle_incoming treated TunnResult::Err as fatal.","Remote unauthenticated DoS on exposed UDP links.","Log and drop invalid packets instead of returning an error.","cargo test (wireguard::tests::handle_incoming_drops_invalid_packet)","fixed"
"VTR-002","High","Functional/Availability","Daemon lifecycle","src/main.rs:81; src/main.rs:90","If the WireGuard task exits, the main process kept running and waited for Ctrl+C.","WireGuard task was spawned and not awaited.","Silent failure with an idle but still-running process.","Added run_until_shutdown to monitor task completion and propagate errors.","cargo test (tests::run_until_shutdown_*)","fixed"
"VTR-003","Medium","Functional/Configuration","Config validation","src/config.rs:111","Config accepted invalid combinations such as timeout <= default interval, buffer_size < mtu, and mtu > u16::MAX.","Validation only compared timeout when interval was explicitly set and did not bound MTU or buffer size.","Link flapping, packet truncation, and misconfigured TUN device.","Validated MTU upper bound, buffer_size >= MTU, and timeout against effective interval.","cargo test (config::tests::validate_config_*)","fixed"
"VTR-004","Medium","Functional/Integration","Link health checks","src/wireguard.rs:425","Links with no RX were never marked down even after repeated health pings.","is_available only checked last_rx and ignored last_ping_sent.","Failover/aggregate modes may keep sending to dead links.","Consider last_ping_sent when last_rx is absent.","cargo test (wireguard::tests::link_marks_down_after_missed_pong)","fixed"
"VTR-005","Medium","Integration/Network","Link socket setup","src/wireguard.rs:335","IPv6 endpoints defaulted to IPv4 bind address, causing send failures.","Bind selection occurred before endpoint resolution and defaulted to 0.0.0.0:0.","IPv6 links fail unless bind is manually set.","Resolve endpoint first and choose bind address by IP family.","cargo test (wireguard::tests::default_bind_addr_prefers_ipv6_for_ipv6_remote)","fixed"
